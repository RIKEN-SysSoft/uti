# uti spec file usage:
# (cd SOURCES && git clone 
# put uti.spec to SPECS and uti-@UTI_VERSION@.tar.gz to SOURCES
# rpmbuild -ba uti.spec

# Prevent rpmbuild from including build-id directories into package
%define _build_id_links none

%define uti_version @UTI_VERSION@

Name: uti
Version: %{uti_version}
Release: 1%{?dist}
Summary: Utility Thread Offloading Library
License: GPLv2
%undefine _disable_source_fetch
Source0: https://github.com/RIKEN-SysSoft/uti/archive/%{uti_version}.tar.gz
%define SHA256SUM0 1be173aa9d2da25cee207b7d7b838846ff3703aff44f798e7e17bfb20e52b538
BuildRequires: libcap-dev rdma-core-devel
Requires: libcap rdma-core

%description
Utility Thread Offloading Library

%package	devel
Summary:	Headers and libraries required for build apps using UTI
Requires:	%{name} = %{version}-%{release}

%description	devel
This package contains headers and libraries required for build apps using UTI.

%prep
echo "%SHA256SUM0 %SOURCE0" | sha256sum -c -
%setup -q

%build
%configure --with-rm=linux
make %{?_smp_mflags}

%install
%make_install

%files
%{_libdir}/libuti.so
%{_libdir}/libuti.so.0
%{_libdir}/libuti.so.0.0.0
%{_libdir}/libuti.a
%{_libdir}/libuti.la

%files	devel
%{_includedir}/uti.h

%changelog
* Fri May 1 2020 Masamichi Takagi <masamichi.takagi@riken.jp> - 1.0.0-
- Initial package
